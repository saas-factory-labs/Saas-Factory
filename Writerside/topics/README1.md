<h1 align="center">  üèóÔ∏è SaaS Factory </h1>

<h4> Blueprint for deploying any type of B2B/B2B SaaS to massively accelerate development speed and time to market of a new SaaS web application by reducing the to create boilerplate code and infrastructure.
 </h4>

 <h5 align="center">

<p> Database schema diagram for Appblueprint-Dev-Db </p>

[![Explore database with Azimutt](https://img.shields.io/badge/PostgreSQL-browse_online-gray?labelColor=4169E1&logo=postgresql&logoColor=fff&style=flat)](https://azimutt.app/create?sql=https://diagram-hosting-proxy.casper-c7c.workers.dev/schema.sql)

</h5>

<div align="center">

[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=alert_status&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/summary/new_code?id=saas-factory-labs_SaaS-Factory)

[![Bugs](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=bugs&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/summary/new_code?id=saas-factory-labs_SaaS-Factory)

[![Code Smells](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=code_smells&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/summary/new_code?id=saas-factory-labs_SaaS-Factory)

[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=coverage&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/summary/new_code?id=saas-factory-labs_SaaS-Factory)

[![Duplicated Lines (%)](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=duplicated_lines_density&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/summary/new_code?id=saas-factory-labs_SaaS-Factory)

[![Security Rating](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=security_rating&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/component_measures?id=saas-factory-labs_SaaS-Factory&metric=Security)

[![Reliability Rating](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=reliability_rating&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/component_measures?id=saas-factory-labs_SaaS-Factory&metric=Reliability)

[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=sqale_rating&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/component_measures?id=saas-factory-labs_SaaS-Factory&metric=Maintainability)

[![Vulnerabilities](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=vulnerabilities&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/project/issues?id=saas-factory-labs_SaaS-Factory&resolved=false&types=VULNERABILITY)

[![Technical Debt ](https://sonarcloud.io/api/project_badges/measure?project=saas-factory-labs_SaaS-Factory&metric=sqale_index&token=89f95cfc8e92f83ea5e918077e5da95e9b5a9754)](https://sonarcloud.io/component_measures?id=saas-factory-labs_SaaS-Factory&metric=squale_index)

</div>

 <details>

 <summary> 
   <h4>Vision </h4>  
 </summary> 

 Deploying a new SaaS app project working with one command via the Developer Cli and then adding features specific to the application, while all the fundamental is in place already in under 30 minutes

 </details>
 
 <details>

 <summary>
  <h4>Purpose </h4>  
 </summary> 

The ultimate purpose is to deploy the projects I have wanted to fullfill for a long time both personal and business related and to deploy software SaaS products that can help me get to financial freedom and escape the worry and stress of the dreaded 9-5 hamster wheel along with the incompetent leaders that run those corporations, so I can finally live on my own terms!

 </details>
 
 <details>

 <summary>

<h4> Objectives </h4>
  
 </summary>

- Fun to work with and develop
- Consolidated shared infrastructure
- Fast continuous deployment of code to infrastructure (deploy automatically after passing automated QA environment testing processes)
- Cost-effective
- Secure
- Fast development on new or existing software-as-a-service projects
- familiar tech stack (C# as much as possible)
- Minimal technical debt (standardized implementations, code clean up, modular flexible structure, tracking, and maintenance of code and database migration drift)
- Mono repo for SaaS deployment manager system and boilerplate code for deploying SaaS web app project in a separate repo
- Automated processes
- Disaster recovery implementation
- Automated documentation
- Dev, QA (automated), staging, and production environment
- Cloudagnostic (can easiliy be migrated to another cloud provider such as digialocean/linode/Cloudservers.dk/Render.com

</details>

<details>

<summary>
  <h4>  Complexities </h4>
</summary>

- Maintaining and keeping multiple deployed SaaS web applications up to date to mitigate technical debt
- Adhering to a high-level perspective and focus while being able to deepdive into low level programming and troubleshooting
- MVP status - When and how can the first SaaS Factory App be deployed?
- Should Deployment Manager be added in version 2 of SaaS Factory and how can existing deployed SaaS web apps be consolidated and migrated?
  
</details>  



> [!NOTE]
> Useful information that users should know, even when skimming content.

> [!TIP]
> Helpful advice for doing things better or more easily.

> [!IMPORTANT]
> Key information users need to know to achieve their goal.

> [!WARNING]
> Urgent info that needs immediate user attention to avoid problems.

> [!CAUTION]
> Advises about risks or negative outcomes of certain actions.

### ‚ÑπÔ∏è Definitions

- Entity
- DTO
  - Request
  - Response
- Interfaces
- Services
- Repositories
- Database
  - Migrations
  - Contexts


### üîó Related repositories 

[Hosting](https://github.com/saas-factory-labs/Hosting)

[Milan clean architecture](https://github.com/saas-factory-labs/milanjanovich-clean-architecture-course)

[Didact](https://github.com/DidactHQ/didact-engine)

[Blazor Diagrams](https://github.com/Blazor-Diagrams/Blazor.Diagrams)

[K6 load testing](https://github.com/saas-factory-labs/K6-Loadtest)

### üîó App Projects

[File Discovery](https://github.com/saas-factory-labs/File-Discovery)

[GroceryBot](https://github.com/saas-factory-labs/GroceryBot)

[Cooligram](https://github.com/saas-factory-labs/Cooligram)

[Free Dating](https://github.com/saas-factory-labs/Free-Dating)

[Boligportal](https://github.com/saas-factory-labs/Boligportal)

### üõ†Ô∏è  Prerequisites

<details>

<summary>Install prerequisites for development on Windows</summary>
	
1.	Open a PowerShell terminal as Administrator and run the following command to install Windows Subsystem for Linux (required for Docker):
  
    `wsl --install`

2.	Restart your computer if prompted.

3.	Install .NET, Git, Docker Desktop, Node.js, Azure CLI, and GitHub CLI using winget (available only on Windows 11):

    ```powershell
    @(
        "Microsoft.DotNet.SDK.9",
        "Git.Git",
        "Docker.DockerDesktop",
        "OpenJS.NodeJS",
    	"npm install wrangler --save-dev"
        "GitHub.cli"    	
    ) | ForEach-Object { winget install --accept-package-agreements --accept-source-agreements --id $_ }
    
    "gh extension install https://github.com/nektos/gh-act"
    ```
</details>

# üóÇÔ∏è File structure in the git repository

SaaS-Factory is a [monorepo](https://en.wikipedia.org/wiki/Monorepo) containing all application code, infrastructure, tools, libraries, documentation, etc. 
A monorepo is a powerful way to organize a codebase, used by Google, Facebook, Uber, Microsoft, etc.

```bash
‚îú‚îÄ .github                            # Separate GitHub workflows for deploying Infrastructure and app
‚îú‚îÄ Code                               # Contains the application source code
‚îÇ  ‚îú‚îÄ AppBlueprint        
‚îÇ     ‚îú‚îÄ Appblueprint.AppHost         # .NET Aspire project starting app and all dependencies in Docker
‚îÇ      ‚îú‚îÄ Appblueprint.Gateway        # Blazor Server app utilizing Mudblazor components
‚îÇ      ‚îú‚îÄ Appblueprint.Web            # Blazor Server app utilizing Mudblazor components
‚îÇ      ‚îú‚îÄ Appblueprint.ApiService     # .Net Rest/GraphQL API
‚îÇ      ‚îú‚îÄ Appblueprint.Workers        # Background workers for long-running tasks and event processing
‚îÇ      ‚îú‚îÄ Appblueprint.SharedKernel   # Shared code between all projects
‚îÇ      ‚îú‚îÄ Appblueprint.UiKit          # Shared UI components
‚îÇ      ‚îú‚îÄ Appblueprint.Tests          # Tests for all projects‚îÇ  ‚îÇ   
‚îÇ‚îÄ‚îú‚îÄ [saas-scs]                      # [Your SCS] Create your SaaS product as a self-contained system
‚îÇ ‚îî‚îÄ back-office                     # A self-contained system for operations and support (empty for now)
‚îú‚îÄ cloud-infrastructure               # Contains Bash and Bicep scripts (IaC) for Azure resources
‚îî‚îÄ development-cli                    # A .NET CLI tool for automating common developer tasks
```


<details>

<summary>

## Use case features of App Blueprint
 
</summary>

- [ ] User management
    - [ ] Register a new user account
    - [ ] Login with existing user account
    - [ ] Logout from user account
    - [ ] Manage user profile
    - [ ] Manage user account settings    
    - [ ] File management
      - [ ] Upload a file
      - [ ] Download a file
      - [ ] Delete a file
      - [ ] Share a file
      - [ ] Manage files
      - [ ] Search and filter for a file
      - [ ] Export user data
    - [ ] Notification management
      - [ ] View notifcations
      - [ ] Check off notifications as read
    - [ ] Data export
        - [ ] Export user data

- [ ] Role and Permission management
  - [ ] Customer admin should be able to manage roles and permisions
  - [ ] Customer admin should be able to create a team
  - [ ] Customer admin should be able to assign members to a team
  - [ ] Customer admin should be able to create API keys

- [ ] Tenant management
  - [ ] Automatically provision a new tenant for a customer that signs up
    
- [ ] Subscription management
  -  [ ] Create a new subscription for a customer that signs up to a paid plan
  -  [ ] Cancel existing subscription
    
- [ ] Payment management
  - [ ] Create a payment intent for a customer that signs up to a paid subscription plan
  - [ ] Create a payment intent for a customer that that purchases a perperual license
  - [ ] Create a payment intent for a customer that that purchases credits

- [ ] Admin Management (My own access to manage my customers and their subscriptions across deployed SaaS app products)
  - [ ] Manage all users
  - [ ] Manage all tenants
  - [ ] Manage all subscriptions
  - [ ] Manage all payment intents
  - [ ] Manage all payment transactions
  - [ ] Manage all roles and permissions
  - [ ] Manage all customers

- [ ] Invoice management
  - [ ] Create a new invoice for a customer that signs up to a paid plan
  - [ ] Send invoice to customer
  - [ ] Manage invoices  

- [ ] Audit log
  - [ ] User activity
  - [ ] User audit log
- [ ] Settings
- [ ] Dashboard
- [ ] Reporting  

- [ ] Onboarding flow for new customers
  - [ ] Set user details such as name, age and so on
  - [ ] Set business details such as company name, VAT and so on
 
</details>

<details>

<summary>

## üìô Architectural decision record for SaaS Factory
 
</summary>

- Shared API vs. Separate API for each SaaS app project [Seperate API: APPROVED]
    
    - Purpose
        - Shared API for all deployed SaaS apps
        - Shared API for Deployment Manager
        - Shared API for App Blueprint
    - Disadvantages of shared API:
        - Higher complexity
          - Single point of failure for all projects
          - Risk of calling database from API Controller that does not belong to the correct SaaS app and possible data leakage

    - Advantages of shared API:
        - Lower technical debt as there is no code drift between Appblueprint and the app projects' code
        - No duplicated API code
        - Easier to maintain and update

- Deployment Manager

  - Purpose
    - Command center to control deployment, monitoring and management of deployed SaaS apps
    - Shared Infrastructure with deployed SaaS apps
    - Integration application landscape
    - Manage customers and track growth metrics

- App Blueprint

  - Purpose
    - Template for deploying a SaaS App

- Deployed SaaS App
  - Purpose
    - Personal or commercial App (B2C or B2B or Developer first)

### Application structure

- Domain Driven Design
- Clean Architecture
  - Low technical debt
  - Reliability

### Self Contained Deployment Manager Modules

- DeploymentManager.Web

  - Command center portal

- DeploymentManager.Api

  - Rest API
  - GraphQL API

- DeploymentManager.Codeflow

   - Dependency Tracker

- DeploymentManager.Shared

  - Shared DTOs
  - Shared Enums
  - Shared Entities

- Shared Infrastructure

#### Self Contained Deployed SaaS App

- App-Blueprint template

- FileDiscovery.Web

  - Customer management portal
  - Partner portal
  - Admin portal

- FileDiscovery.Api

  - Rest API
  - GraphQL API


### Tech stack

#### Frontend

- Blazor
  - Dotnet familiarity
  - Performant
  - Can run everywhere as Web Assembly or hosted server web app
  - Strong integration with dotnet backend technologies
  - Mudblazor framework for fast user interface development
    - 3rd party mudextensions
      - https://codebeam-mudextensions.pages.dev

#### Backend

- Dotnet
  - Familiarity => High productivity
  - Performant
- YARP Proxy
- Authentication solution eg. Supertokens

#### : Infrastruture

- Railway
  - PostgreSQL databases 
- Cloudflare R2 blob storage
- Redis Cloud
- Algolia
- Grafana Cloud
- Cloudflare
- Stripe
- Resend
- Azure Key Vault
- Logsnag
- Cookiebot
- Microsoft Clarity
- Google Recaptcha
- Google Analytics
- Google Tag Manager

#### Monitoring and observability

- Open Telemetry

#### CI/CD

- Github Actions
- Pulumi Automation API
- Cloudcostify API
- Sonarcloud

#### Testing

- NSubstitute
- xUnit
- Bogus
- Architecture testing
- Function testing
- Integration testing
- Performance test (Grafana K6)
  - Smoke test
  - Load test

#### Documentation

- Deployment Manager dependency tracking map
- Dive (docker image analysis)
- Github Copilot automatic documentation
- Automatic swagger Rest API documentation
- Automatic GraphQL schema documentation
- Open Telemetry dependencies map
- Standards
  - Naming convention
  - Sonarcloud Gate
    - Technical debt under 1 hour
  - Project file structure

#### Security

- CORS
- CSRF
- HSTS
- CSP
- Zero trust & no credentials
- IP whitelisting
- Monitoring
- Pentesting
- Cloudflare DDOS protection

#### Development tools

- Microsoft SQL Studio
- Visual Studio 2022
- Github Copilot (Chat & Voice)
- VS Code
- Docker Desktop
- Postman
 
</details>

![Visualization of the codebase](._diagram.svg)

https://themes.arctechonline.tech/export

https://gitkraken.dev/launchpad?prs=github&issues=github
