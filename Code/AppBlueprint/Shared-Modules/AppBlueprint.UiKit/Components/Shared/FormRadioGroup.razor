@* Radio group component *@

<div class="@ContainerClass">
    @if (!string.IsNullOrEmpty(Label))
    {
        <label class="block text-sm font-medium mb-2 @LabelClasses">
            @Label
            @if (Required)
            {
                <span class="text-red-500">*</span>
            }
        </label>
    }
    <div class="@GetLayoutClasses()">
        @foreach (var option in Options)
        {
            <label class="flex items-center @(Disabled ? "cursor-not-allowed opacity-60" : "cursor-pointer")">
                <input
                    type="radio"
                    name="@Name"
                    value="@option.Value"
                    class="@GetRadioClasses()"
                    checked="@(Value == option.Value)"
                    disabled="@Disabled"
                    @onchange="() => OnChange(option.Value)" />
                <span class="text-sm @(Disabled ? "text-gray-400" : "text-gray-600 dark:text-gray-400") ml-2">
                    @option.Label
                </span>
            </label>
        }
    </div>
    @if (!string.IsNullOrEmpty(HelpText) && !HasError)
    {
        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">@HelpText</p>
    }
    @if (HasError && !string.IsNullOrEmpty(ErrorMessage))
    {
        <p class="text-xs text-red-500 mt-2">@ErrorMessage</p>
    }
</div>

@code {
    [Parameter] public string Name { get; set; } = Guid.NewGuid().ToString();
    [Parameter] public string? Label { get; set; }
    [Parameter] public string? Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    [Parameter] public List<RadioOption> Options { get; set; } = new();
    [Parameter] public string? HelpText { get; set; }
    [Parameter] public string? ErrorMessage { get; set; }
    [Parameter] public bool HasError { get; set; } = false;
    [Parameter] public bool Disabled { get; set; } = false;
    [Parameter] public bool Required { get; set; } = false;
    [Parameter] public string Variant { get; set; } = "violet"; // violet, sky, green, red
    [Parameter] public string Layout { get; set; } = "vertical"; // vertical, horizontal
    [Parameter] public string? ContainerClass { get; set; }

    private string LabelClasses => HasError ? "text-red-500" : "text-gray-800 dark:text-gray-100";

    private string GetLayoutClasses()
    {
        return Layout == "horizontal"
            ? "flex flex-wrap gap-4"
            : "space-y-2";
    }

    private string GetRadioClasses()
    {
        var colorClass = Variant switch
        {
            "sky" => "text-sky-500 focus:ring-sky-500/20",
            "green" => "text-green-500 focus:ring-green-500/20",
            "red" => "text-red-500 focus:ring-red-500/20",
            _ => "text-violet-500 focus:ring-violet-500/20"
        };

        var stateClass = HasError ? "border-red-500" : "border-gray-300 dark:border-gray-600";

        return $"form-radio {stateClass} {colorClass}";
    }

    private async Task OnChange(string value)
    {
        Value = value;
        await ValueChanged.InvokeAsync(Value);
    }

    public class RadioOption
    {
        public string Value { get; set; } = "";
        public string Label { get; set; } = "";
    }
}
