@* Accordion item component *@

<div class="py-2">
    <button
        type="button"
        class="flex items-center justify-between w-full text-left py-2 font-medium text-gray-800 dark:text-gray-100 hover:text-violet-500 dark:hover:text-violet-400"
        aria-expanded="@IsOpen"
        @onclick="Toggle">
        <span>@Title</span>
        <svg class="shrink-0 ml-2 fill-current text-gray-400 dark:text-gray-500 transition-transform duration-200 @(IsOpen ? "rotate-180" : "")" width="12" height="12" viewBox="0 0 12 12">
            <path d="M5.9 11.4L.5 6l1.4-1.4 4 4 4-4L11.3 6z" />
        </svg>
    </button>
    @if (IsOpen)
    {
        <div class="text-sm text-gray-600 dark:text-gray-400 py-2">
            @ChildContent
        </div>
    }
</div>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public string Id { get; set; } = "";
    [Parameter] public string Title { get; set; } = "";
    [Parameter] public bool IsOpen { get; set; }
    [Parameter] public EventCallback<bool> IsOpenChanged { get; set; }
    [CascadingParameter] public Accordion? ParentAccordion { get; set; }

    private async Task Toggle()
    {
        if (ParentAccordion != null)
        {
            ParentAccordion.Toggle(Id);
            IsOpen = ParentAccordion.IsExpanded(Id);
        }
        else
        {
            IsOpen = !IsOpen;
        }
        await IsOpenChanged.InvokeAsync(IsOpen);
    }

    protected override void OnParametersSet()
    {
        if (ParentAccordion != null)
        {
            IsOpen = ParentAccordion.IsExpanded(Id);
        }
    }
}
