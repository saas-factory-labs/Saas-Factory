@namespace AppBlueprint.UiKit.Components.Shared

@* Simple two-column data table - reusable for statistics, rankings, summaries *@

<div class="overflow-x-auto">
    <table class="table-auto w-full dark:text-gray-300" @attributes="AdditionalAttributes">
        @if (ChildContent != null)
        {
            @ChildContent
        }
        else
        {
            <!-- Table header -->
            <thead class="text-xs uppercase text-gray-400 dark:text-gray-500 @(HasHeaderBackground ? "bg-gray-50 dark:bg-gray-700/50 rounded-xs" : "")">
                <tr>
                    <th class="@GetHeaderPaddingClass()">
                        <div class="font-semibold @GetLabelAlignClass()">@LabelHeader</div>
                    </th>
                    <th class="@GetHeaderPaddingClass()">
                        <div class="font-semibold @GetValueAlignClass()">@ValueHeader</div>
                    </th>
                </tr>
            </thead>
            <!-- Table body -->
            <tbody class="text-sm divide-y divide-gray-100 dark:divide-gray-700/60">
                @foreach (var item in Items)
                {
                    <tr>
                        <td class="@GetBodyPaddingClass()">
                            <div class="@GetLabelAlignClass() @GetLabelTextClass()">@item.Label</div>
                        </td>
                        <td class="@GetBodyPaddingClass()">
                            <div class="@GetValueAlignClass() @GetValueTextClass()">@item.Value</div>
                        </td>
                    </tr>
                }
            </tbody>
        }
    </table>
</div>

@code {
    /// <summary>
    /// Header text for the label column
    /// </summary>
    [Parameter]
    public string LabelHeader { get; set; } = string.Empty;

    /// <summary>
    /// Header text for the value column
    /// </summary>
    [Parameter]
    public string ValueHeader { get; set; } = string.Empty;

    /// <summary>
    /// List of data items to display
    /// </summary>
    [Parameter] public List<DataItem> Items { get; set; } = [];

    [Parameter] public string? Icon { get; set; }
    [Parameter] public string? Class { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object>? AdditionalAttributes { get; set; }

    /// <summary>
    /// Label column alignment: left, center, right
    /// </summary>
    [Parameter]
    public string LabelAlign { get; set; } = "left";

    /// <summary>
    /// Value column alignment: left, center, right
    /// </summary>
    [Parameter]
    public string ValueAlign { get; set; } = "right";

    /// <summary>
    /// Whether to show background color on header
    /// </summary>
    [Parameter]
    public bool HasHeaderBackground { get; set; } = false;

    /// <summary>
    /// Padding style: compact (py-2), normal (p-2)
    /// </summary>
    [Parameter]
    public string Padding { get; set; } = "compact";

    /// <summary>
    /// Whether values should be bold
    /// </summary>
    [Parameter]
    public bool BoldValues { get; set; } = true;

    /// <summary>
    /// Custom CSS class for value cells
    /// </summary>
    [Parameter]
    public string? ValueClass { get; set; }

    private string GetHeaderPaddingClass()
    {
        return Padding.ToLower() switch
        {
            "compact" => "py-2",
            "normal" => "p-2",
            "spacious" => "p-3",
            _ => "py-2"
        };
    }

    private string GetBodyPaddingClass()
    {
        return Padding.ToLower() switch
        {
            "compact" => "py-2",
            "normal" => "p-2 whitespace-nowrap",
            "spacious" => "p-3 whitespace-nowrap",
            _ => "py-2"
        };
    }

    private string GetLabelAlignClass()
    {
        return $"text-{LabelAlign.ToLower()}";
    }

    private string GetValueAlignClass()
    {
        return $"text-{ValueAlign.ToLower()}";
    }

    private string GetLabelTextClass()
    {
        return ""; // Plain text for labels
    }

    private string GetValueTextClass()
    {
        string baseClass = BoldValues ? "font-medium text-gray-800 dark:text-gray-100" : "";
        return string.IsNullOrEmpty(ValueClass) ? baseClass : $"{baseClass} {ValueClass}";
    }

    /// <summary>
    /// Data item model for table rows
    /// </summary>
    public sealed record DataItem(string Label, string Value);
}
