@* Masonry Grid component with responsive columns *@
@typeparam TItem

<div class="@GetContainerClasses()" style="@GetContainerStyles()">
    @if (Items != null)
    {
        @foreach (var (item, index) in Items.Select((item, i) => (item, i)))
        {
            <div class="@GetItemClasses()" style="@GetItemStyles(index)">
                @if (ItemTemplate != null)
                {
                    @ItemTemplate(item)
                }
            </div>
        }
    }
</div>

@code {
    [Parameter] public IEnumerable<TItem>? Items { get; set; }
    [Parameter] public RenderFragment<TItem>? ItemTemplate { get; set; }
    [Parameter] public int Columns { get; set; } = 3;
    [Parameter] public int ColumnsSm { get; set; } = 1;
    [Parameter] public int ColumnsMd { get; set; } = 2;
    [Parameter] public int ColumnsLg { get; set; } = 3;
    [Parameter] public int ColumnsXl { get; set; } = 4;
    [Parameter] public string Gap { get; set; } = "1.5rem";
    [Parameter] public string? Class { get; set; }

    private string GetContainerClasses()
    {
        return $"columns-{ColumnsSm} md:columns-{ColumnsMd} lg:columns-{ColumnsLg} xl:columns-{ColumnsXl} {Class}".Trim();
    }

    private string GetContainerStyles()
    {
        return $"column-gap: {Gap};";
    }

    private string GetItemClasses()
    {
        return "break-inside-avoid mb-[var(--masonry-gap)]";
    }

    private string GetItemStyles(int index)
    {
        return $"--masonry-gap: {Gap};";
    }
}
