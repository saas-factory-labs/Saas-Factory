@* Cart Items - Now using modular, reusable components *@
@inject ThemeService ThemeService

<ul>
    @foreach (var item in CartItemsList)
    {
        <CartItem 
            Title="@item.Title"
            Description="@item.Description"
            ImageUrl="@item.ImageUrl"
            ImageAlt="@item.ImageAlt"
            ProductUrl="@item.ProductUrl"
            Rating="@item.Rating"
            Price="@item.Price"
            OnRemove="@(() => RemoveItem(item))" />
    }
</ul>

<div class="mt-6 text-center lg:text-left">
    <a class="@ThemeService.GetLinkClasses()" href="#0">&lt;- Back To Shopping</a>
</div>

@code {
    /// <summary>
    /// List of cart items to display
    /// </summary>
    [Parameter]
    public List<CartItemModel> CartItemsList { get; set; } = new();

    /// <summary>
    /// Event callback when an item is removed from cart
    /// </summary>
    [Parameter]
    public EventCallback<CartItemModel> OnItemRemoved { get; set; }

    protected override void OnInitialized()
    {
        // Initialize with sample data if empty (for demo purposes)
        if (CartItemsList.Count == 0)
        {
            CartItemsList = GetSampleCartItems();
        }
    }

    private async Task RemoveItem(CartItemModel item)
    {
        CartItemsList.Remove(item);
        await OnItemRemoved.InvokeAsync(item);
    }

    private List<CartItemModel> GetSampleCartItems()
    {
        return new List<CartItemModel>
        {
            new()
            {
                Title = "The Complete Front-End Development Course!",
                Description = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut.",
                ImageUrl = "_content/AppBlueprint.UiKit/images/related-product-01.jpg",
                ImageAlt = "Product 01",
                Rating = 4.2,
                Price = 89.00,
                ProductUrl = "#0"
            },
            new()
            {
                Title = "Web Development Ultimate Course 2024",
                Description = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut.",
                ImageUrl = "_content/AppBlueprint.UiKit/images/related-product-02.jpg",
                ImageAlt = "Product 02",
                Rating = 4.2,
                Price = 89.00,
                ProductUrl = "#0"
            },
            new()
            {
                Title = "Full-Stack JavaScript Course!",
                Description = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut.",
                ImageUrl = "_content/AppBlueprint.UiKit/images/related-product-03.jpg",
                ImageAlt = "Product 03",
                Rating = 4.2,
                Price = 89.00,
                ProductUrl = "#0"
            }
        };
    }

    /// <summary>
    /// Model representing a cart item
    /// </summary>
    public sealed class CartItemModel
    {
        public string Title { get; set; } = string.Empty;
        public string? Description { get; set; }
        public string ImageUrl { get; set; } = string.Empty;
        public string ImageAlt { get; set; } = string.Empty;
        public double Rating { get; set; }
        public double Price { get; set; }
        public string ProductUrl { get; set; } = "#0";
    }
}
