@page "/community/feed"
@using AppBlueprint.UiKit.Components.Pages.FeedComponents

<div class="px-4 sm:px-6 lg:px-8 py-8 md:py-0 w-full max-w-[96rem] mx-auto">

    <div class="xl:flex">

        <!-- Left + Middle content -->
        <div class="md:flex flex-1">

            <!-- Left content -->
            <div class="w-full md:w-60 mb-8 md:mb-0">
                <div class="md:sticky md:top-16 md:h-[calc(100dvh-64px)] md:overflow-x-hidden md:overflow-y-auto no-scrollbar">
                    <div class="md:py-8">

                        <!-- Title -->
                        <header class="mb-6">
                            <h1 class="text-2xl md:text-3xl text-gray-800 dark:text-gray-100 font-bold">Feed</h1>
                        </header>

                        <!-- Search form (mobile) -->
                        <div class="xl:hidden mb-6">
                            <div class="relative">
                                <label for="feed-search-mobile" class="sr-only">Search</label>
                                <input id="feed-search-mobile" class="form-input w-full pl-9 bg-white dark:bg-gray-800" type="search" placeholder="Search..." @bind="searchQuery" />
                                <button class="absolute inset-0 right-auto group" type="submit" aria-label="Search">
                                    <svg class="shrink-0 fill-current text-gray-400 dark:text-gray-500 group-hover:text-gray-500 dark:group-hover:text-gray-400 ml-3 mr-2" width="16" height="16" viewBox="0 0 16 16">
                                        <path d="M7 14c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7zM7 2C4.243 2 2 4.243 2 7s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z" />
                                        <path d="M15.707 14.293L13.314 11.9a8.019 8.019 0 01-1.414 1.414l2.393 2.393a.997.997 0 001.414 0 .999.999 0 000-1.414z" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Links -->
                        <div class="flex flex-nowrap overflow-x-scroll no-scrollbar md:block md:overflow-auto px-4 md:space-y-3 -mx-4">
                            <!-- Group 1 -->
                            <div>
                                <div class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase mb-3 md:sr-only">Menu</div>
                                <ul class="flex flex-nowrap md:block mr-3 md:mr-0">
                                    <FeedNavigationLink Label="Home"
                                                        Href="#"
                                                        IconPath="M4.904 10.114a.98.98 0 0 1 0-1.961h5.886a.98.98 0 0 1 0 1.961H4.904ZM2.863 5.166a1.962 1.962 0 0 0-.901 1.651v5.26c0 1.083.878 1.961 1.961 1.961h7.85a1.962 1.962 0 0 0 1.961-1.961v-5.26c0-.668-.34-1.29-.901-1.65L7.848 1.961 2.863 5.166ZM6.786.312a1.962 1.962 0 0 1 2.123 0l4.985 3.204a3.923 3.923 0 0 1 1.802 3.301v5.26A3.923 3.923 0 0 1 11.772 16H3.923A3.923 3.923 0 0 1 0 12.077v-5.26c0-1.335.679-2.579 1.802-3.3L6.786.311Z"
                                                        IsActive="true" />
                                    <FeedNavigationLink Label="Explore"
                                                        Href="#"
                                                        IconPath="M8 3.414V6a1 1 0 1 1-2 0V1a1 1 0 0 1 1-1h5a1 1 0 0 1 0 2H9.414l6.293 6.293a1 1 0 1 1-1.414 1.414L8 3.414Zm0 9.172V10a1 1 0 1 1 2 0v5a1 1 0 0 1-1 1H4a1 1 0 0 1 0-2h2.586L.293 7.707a1 1 0 0 1 1.414-1.414L8 12.586Z" />
                                    <FeedNavigationLink Label="Notifications"
                                                        Href="#"
                                                        IconPath="M5 9a1 1 0 1 1 0-2h6a1 1 0 0 1 0 2H5ZM1 4a1 1 0 1 1 0-2h14a1 1 0 0 1 0 2H1Zm0 10a1 1 0 0 1 0-2h14a1 1 0 0 1 0 2H1Z" />
                                    <FeedNavigationLink Label="Bookmarks"
                                                        Href="#"
                                                        IconPath="M13 4a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v9.131l4.445-2.963a1 1 0 0 1 1.11 0L13 13.13V4Zm-5 8.202-5.445 3.63A1 1 0 0 1 1 15V4a4 4 0 0 1 4-4h6a4 4 0 0 1 4 4v11a1 1 0 0 1-1.555.832L8 12.202Z" />
                                    <FeedNavigationLink Label="Profile"
                                                        Href="/community/profile"
                                                        IconPath="M8 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8Zm0-2a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm-5.143 7.91a1 1 0 1 1-1.714-1.033A7.996 7.996 0 0 1 8 10a7.996 7.996 0 0 1 6.857 3.877 1 1 0 1 1-1.714 1.032A5.996 5.996 0 0 0 8 12a5.996 5.996 0 0 0-5.143 2.91Z" />
                                </ul>
                            </div>
                            <!-- Group 2 -->
                            <div>
                                <div class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase mb-3">My Groups</div>
                                <ul class="flex flex-nowrap md:block mr-3 md:mr-0">
                                    <FeedNavigationLink Label="Productivity"
                                                        Href="#"
                                                        IconPath="M7.3 8.7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-7 7c-.4.4-1 .4-1.4 0ZM7.3 14.7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-7 7c-.4.4-1 .4-1.4 0ZM.3 9.7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-7 7c-.4.4-1 .4-1.4 0Z" />
                                    <FeedNavigationLink Label="Self Development"
                                                        Href="#"
                                                        IconPath="M7.3 8.7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-7 7c-.4.4-1 .4-1.4 0ZM7.3 14.7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-7 7c-.4.4-1 .4-1.4 0ZM.3 9.7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-7 7c-.4.4-1 .4-1.4 0Z" />
                                </ul>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Middle content -->
            <div class="flex-1 md:ml-8 xl:mx-4 2xl:mx-8">
                <div class="md:py-8">

                    <!-- Blocks -->
                    <div class="space-y-4">

                        <!-- Post Block -->
                        <div class="bg-white dark:bg-gray-800 shadow-xs rounded-xl p-5">
                            <div class="flex items-center space-x-3 mb-5">
                                <img class="rounded-full shrink-0" src="_content/AppBlueprint.UiKit/images/user-40-02.jpg" width="40" height="40" alt="User 02" />
                                <div class="grow">
                                    <label for="status-input" class="sr-only">What's happening, Mark?</label>
                                    <input id="status-input" class="form-input w-full bg-gray-100 dark:bg-gray-700 border-transparent dark:border-transparent focus:bg-white dark:focus:bg-gray-800 placeholder-gray-500" type="text" placeholder="What's happening, Mark?" @bind="newPost" />
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <div class="grow flex space-x-5">
                                    <button class="inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                                        <svg class="fill-violet-400 mr-2" width="16" height="16" viewBox="0 0 16 16">
                                            <path d="M0 0h2v16H0V0Zm14 0h2v16h-2V0Zm-3 7H5c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1h6c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1ZM6 5h4V2H6v3Zm5 11H5c-.6 0-1-.4-1-1v-5c0-.6.4-1 1-1h6c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1Zm-5-2h4v-3H6v3Z" />
                                        </svg>
                                        <span>Media</span>
                                    </button>
                                    <button class="inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                                        <svg class="fill-violet-400 mr-2" width="16" height="16" viewBox="0 0 16 16">
                                            <path d="M6.974 14c-.3 0-.7-.2-.9-.5l-2.2-3.7-2.1 2.8c-.3.4-1 .5-1.4.2-.4-.3-.5-1-.2-1.4l3-4c.2-.3.5-.4.9-.4.3 0 .6.2.8.5l2 3.3 3.3-8.1c0-.4.4-.7.8-.7s.8.2.9.6l4 8c.2.5 0 1.1-.4 1.3-.5.2-1.1 0-1.3-.4l-3-6-3.2 7.9c-.2.4-.6.6-1 .6Z" />
                                        </svg>
                                        <span>GIF</span>
                                    </button>
                                    <button class="inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                                        <svg class="fill-violet-400 mr-2" width="16" height="16" viewBox="0 0 16 16">
                                            <path d="M9.793 10.002a.5.5 0 0 1 .353.853l-1.792 1.793a.5.5 0 0 1-.708 0l-1.792-1.793a.5.5 0 0 1 .353-.853h3.586Zm5.014-4.63c1.178 2.497 1.833 5.647.258 7.928-1.238 1.793-3.615 2.702-7.065 2.702S2.173 15.092.935 13.3c-1.575-2.28-.92-5.431.258-7.927A2.962 2.962 0 0 1 0 3.002a3 3 0 0 1 3-3c.787 0 1.496.309 2.029.806a5.866 5.866 0 0 1 5.942 0A2.96 2.96 0 0 1 13 .002a3 3 0 0 1 3 3c0 .974-.472 1.827-1.193 2.37Zm-1.387 6.79c1.05-1.522.417-3.835-.055-5.078C12.915 5.89 11.192 2.002 8 2.002s-4.914 3.89-5.365 5.082c-.472 1.243-1.106 3.556-.055 5.079.843 1.22 2.666 1.839 5.42 1.839s4.577-.62 5.42-1.84ZM6.67 6.62c.113.443.102.68-.433 1.442-.535.761-1.06 1.297-1.658 1.297-.597 0-1.08-.772-1.07-1.483.01-.71.916-2.306 1.997-2.306.784 0 1.05.607 1.163 1.05Zm3.824-1.05c1.08 0 1.987 1.596 1.997 2.306.01.71-.473 1.483-1.07 1.483-.598 0-1.123-.536-1.658-1.297-.535-.762-.546-1-.432-1.442.113-.443.38-1.05 1.163-1.05Z" />
                                        </svg>
                                        <span>Emoji</span>
                                    </button>
                                </div>
                                <div>
                                    <button type="submit" class="btn-sm bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white whitespace-nowrap">Send -&gt;</button>
                                </div>
                            </div>
                        </div>

                        <!-- Posts -->
                        @foreach (var post in posts)
                        {
                            <FeedPostCard AuthorName="@post.Author"
                                          AuthorImage="@post.Image"
                                          PostTime="@post.Time"
                                          Content="@post.Content"
                                          Likes="@post.Likes"
                                          Shares="@post.Shares"
                                          Comments="@post.Comments" />
                        }

                    </div>

                </div>
            </div>

        </div>

        <!-- Right content -->
        <div class="w-full hidden xl:block xl:w-72">
            <div class="lg:sticky lg:top-16 lg:h-[calc(100dvh-64px)] lg:overflow-x-hidden lg:overflow-y-auto no-scrollbar">
                <div class="md:py-8">

                    <!-- Search form (desktop) -->
                    <div class="mb-6">
                        <div class="relative">
                            <label for="feed-search-desktop" class="sr-only">Search</label>
                            <input id="feed-search-desktop" class="form-input w-full pl-9 bg-white dark:bg-gray-800" type="search" placeholder="Search..." @bind="searchQuery" />
                            <button class="absolute inset-0 right-auto group" type="submit" aria-label="Search">
                                <svg class="shrink-0 fill-current text-gray-400 dark:text-gray-500 group-hover:text-gray-500 dark:group-hover:text-gray-400 ml-3 mr-2" width="16" height="16" viewBox="0 0 16 16">
                                    <path d="M7 14c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7zM7 2C4.243 2 2 4.243 2 7s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z" />
                                    <path d="M15.707 14.293L13.314 11.9a8.019 8.019 0 01-1.414 1.414l2.393 2.393a.997.997 0 001.414 0 .999.999 0 000-1.414z" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Blocks -->
                    <div class="space-y-4">

                        <!-- Block 1 - Top Communities -->
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                            <div class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase mb-4">Top Communities</div>
                            <ul class="space-y-3">
                                @foreach (var community in communities)
                                {
                                    <CommunityListItem Name="@community.Name"
                                                       ImageUrl="@community.Image"
                                                       IsJoined="@community.Joined" />
                                }
                            </ul>
                            <div class="mt-4">
                                <button class="btn-sm w-full bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700/60 hover:border-gray-300 dark:hover:border-gray-600 text-gray-800 dark:text-gray-300">View All</button>
                            </div>
                        </div>

                        <!-- Block 2 - Who to follow -->
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                            <div class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase mb-4">Who to follow</div>
                            <ul class="space-y-3">
                                @foreach (var user in suggestedUsers)
                                {
                                    <UserSuggestionItem Name="@user.Name"
                                                        ImageUrl="@user.Image" />
                                }
                            </ul>
                            <div class="mt-4">
                                <button class="btn-sm w-full bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700/60 hover:border-gray-300 dark:hover:border-gray-600 text-gray-800 dark:text-gray-300">View All</button>
                            </div>
                        </div>

                        <!-- Block 3 - Trends -->
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                            <div class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase mb-4">Trends for you</div>
                            <ul class="space-y-3">
                                @foreach (var trend in trends)
                                {
                                    <TrendItem Title="@trend.Title"
                                               CommentCount="@trend.Comments" />
                                }
                            </ul>
                            <div class="mt-4">
                                <button class="btn-sm w-full bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700/60 hover:border-gray-300 dark:hover:border-gray-600 text-gray-800 dark:text-gray-300">View All</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>

</div>

@code {
    private string searchQuery = "";
    private string newPost = "";
    private List<FeedPost> posts = new();
    private List<Community> communities = new();
    private List<SuggestedUser> suggestedUsers = new();
    private List<Trend> trends = new();

    protected override void OnInitialized()
    {
        posts = new List<FeedPost>
        {
            new() { Author = "Dominik Lamakani", Image = "_content/AppBlueprint.UiKit/images/user-40-03.jpg", Time = "Yesterday at 10:48 AM", Content = "It's more likely that people reading your blog will opt in with their email addresses if you give them something highly relevant in return. Ditch that too-general lead magnet and create \"content upgrades\" for your highest-traffic articles.\nThread", Likes = 4, Shares = 44, Comments = 7 },
            new() { Author = "Erica Spriggs", Image = "_content/AppBlueprint.UiKit/images/user-40-04.jpg", Time = "Yesterday at 2:34 PM", Content = "Any book recommendations for a first-time entrepreneur?", Likes = 122, Shares = 7, Comments = 298 },
            new() { Author = "Margaret Sullivan", Image = "_content/AppBlueprint.UiKit/images/user-40-08.jpg", Time = "Yesterday at 4:56 PM", Content = "Kyla Network - Make new connections, join communities, and access exclusive experiences.", Likes = 2200, Shares = 4300, Comments = 92 }
        };

        communities = new List<Community>
        {
            new() { Name = "Introductions", Image = "_content/AppBlueprint.UiKit/images/group-avatar-01.png" },
            new() { Name = "HackerNews", Image = "_content/AppBlueprint.UiKit/images/group-avatar-02.png" },
            new() { Name = "ReactJs", Image = "_content/AppBlueprint.UiKit/images/group-avatar-03.png", Joined = true },
            new() { Name = "JustChatting", Image = "_content/AppBlueprint.UiKit/images/group-avatar-04.png" }
        };

        suggestedUsers = new List<SuggestedUser>
        {
            new() { Name = "Elly Boutin", Image = "_content/AppBlueprint.UiKit/images/user-32-02.jpg" },
            new() { Name = "Rich Harris", Image = "_content/AppBlueprint.UiKit/images/user-32-04.jpg" },
            new() { Name = "Mary Porzio", Image = "_content/AppBlueprint.UiKit/images/user-32-05.jpg" },
            new() { Name = "Brian Lovin", Image = "_content/AppBlueprint.UiKit/images/user-32-01.jpg" }
        };

        trends = new List<Trend>
        {
            new() { Title = "Tracking your website traffic on launch day", Comments = 248 },
            new() { Title = "Freemium model questions", Comments = 47 },
            new() { Title = "Slack and Community", Comments = 24 },
            new() { Title = "Who owns user onboarding in your company?", Comments = 17 },
            new() { Title = "Questions from a very confused Web3 startup founder", Comments = 9 }
        };
    }

    private class FeedPost
    {
        public string Author { get; set; } = "";
        public string Image { get; set; } = "";
        public string Time { get; set; } = "";
        public string Content { get; set; } = "";
        public int Likes { get; set; }
        public int Shares { get; set; }
        public int Comments { get; set; }
    }

    private class Community
    {
        public string Name { get; set; } = "";
        public string Image { get; set; } = "";
        public bool Joined { get; set; }
    }

    private class SuggestedUser
    {
        public string Name { get; set; } = "";
        public string Image { get; set; } = "";
    }

    private class Trend
    {
        public string Title { get; set; } = "";
        public int Comments { get; set; }
    }
}
