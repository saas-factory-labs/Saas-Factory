# üîç Azimutt Database Analysis Report

> **Database:** `appblueprintdb`  
> **Azimutt CLI Version:** 0.1.38  
> **Tool:** [Azimutt](https://azimutt.app/) ‚Äî Next-Gen ERD & Database Linter  
> **Workflow:** [View latest run](https://github.com/saas-factory-labs/Saas-Factory/actions/workflows/azimutt-database-analysis.yml)

---

## Summary

| Severity | Count |
|----------|------:|
| üî¥ High   | 53    |
| üü† Medium | 30    |
| üîµ Low    | 1     |
| üí° Hint   | 21    |
| **Total** | **105** |

> Scanned **49 entities**, **55 relations**, **0 queries**, **0 types**.

---

## üî¥ High Severity (53 violations)

### Duplicated Indexes ‚Äî 20 violations

Indexes that are made redundant by a composite index covering the same leading column. Safe to drop.

| Redundant Index | Covered By |
|---|---|
| `IX_ApiLogs_ApiKeyId` on `ApiLogs(ApiKeyId)` | `IX_ApiLogs_ApiKeyId_StatusCode(ApiKeyId, StatusCode)` |
| `IX_ApiLogs_SessionId` on `ApiLogs(SessionId)` | `IX_ApiLogs_SessionId_StatusCode(SessionId, StatusCode)` |
| `IX_AuditLogs_Category` on `AuditLogs(Category)` | `IX_AuditLogs_Category_ModifiedAt(Category, ModifiedAt)` |
| _+ 17 more_ | |

### Misaligned Foreign Key Types ‚Äî 33 violations

Foreign key relationships where the referencing and referenced column types differ. This prevents the database from enforcing type safety and may cause implicit casts at query time.

| Relation | Mismatched Types |
|---|---|
| `FK_Accounts_Users_OwnerId` | `Accounts.OwnerId`: `varchar(1024)` ‚â† `Users.Id`: `varchar(40)` |
| `FK_Addresses_Cities_CityId` | `Addresses.CityId`: `varchar(1024)` ‚â† `Cities.Id`: `varchar(40)` |
| `FK_Addresses_Countries_CountryId` | `Addresses.CountryId`: `varchar(1024)` ‚â† `Countries.Id`: `varchar(40)` |
| _+ 30 more_ | |

> **Root cause:** Many FK columns are typed as `varchar(1024)` while the referenced PK columns are `varchar(40)`. Standardise ID column sizes across the schema.

---

## üü† Medium Severity (30 violations)

### Entities with Too-Heavy Indexes ‚Äî 4 violations

Tables where the total index footprint is a multiple of the data size, indicating over-indexing.

| Entity | Index Ratio | Index Count |
|---|---|---|
| `public.Tenants` | 11√ó data size | 12 indexes |
| `public.FileMetadata` | 6√ó data size | 6 indexes |
| `public.WebhookEvents` | 6√ó data size | 6 indexes |
| _+ 1 more_ | | |

### Missing Inferred Relations ‚Äî 26 violations

Columns that follow a `*_id` naming convention but have no declared foreign key constraint. These are likely unintentional omissions.

| Column | Suggested Relation |
|---|---|
| `public.Accounts(UserId)` | ‚Üí `public.Users(Id)` |
| `public.Accounts(TenantId)` | ‚Üí `public.Tenants(Id)` |
| `public.AdminAuditLog(AdminUserId)` | ‚Üí `public.Users(Id)` |
| _+ 23 more_ | |

---

## üîµ Low Severity (1 violation)

### Inconsistent Entity Name ‚Äî 1 violation

| Entity | Issue |
|---|---|
| `public.__EFMigrationsHistory` | Does not follow the `camel-upper` naming convention |

> This is an EF Core internal migration tracking table ‚Äî not actionable.

---

## üí° Hints (21 violations)

### Inconsistent Attribute Types ‚Äî 21 violations

Columns sharing the same logical name but using different data types across tables. This hinders cross-table joins, generic tooling, and readability.

#### `Id` column ‚Äî multiple types in use

| Type | Tables |
|---|---|
| `varchar(40)` | `AuditLogs` (+22 others) |
| `varchar(1024)` | `Accounts` (+19 others) |
| `varchar(50)` | `FileMetadata` |
| `text` | `SignupAuditLog` |
| `integer` | `AdminAuditLog` |

#### `Name` column ‚Äî multiple types in use

| Type | Tables |
|---|---|
| `varchar(1024)` | `Accounts` (+2 others) |
| `varchar(200)` | `Countries` (+4 others) |
| `varchar(100)` | `Cities` (+7 others) |

#### `Email` column ‚Äî multiple types in use

| Type | Tables |
|---|---|
| `varchar(255)` | `Accounts` (+1 other) |
| `varchar(100)` | `Tenants` (+1 other) |
| `text` | `SignupAuditLog` |

_+ 18 more inconsistent attribute type hints_

---

## ‚ÑπÔ∏è Notes

- `pg_stat_statements` is **not enabled**. Enabling it on the PostgreSQL instance will allow Azimutt to analyse slow & degrading queries for additional insights.
- To receive the full report as a JSON file, pass `--email your@email.com` to the CLI.

---

_Generated by [Azimutt CLI](https://www.npmjs.com/package/azimutt) ¬∑ [Re-run analysis](https://github.com/saas-factory-labs/Saas-Factory/actions/workflows/azimutt-database-analysis.yml)_
